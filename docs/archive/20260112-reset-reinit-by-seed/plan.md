# 重置按钮按当前种子重新初始化（Plan）

## 0. 背景与目标（简短即可）
- 背景：
  - 当前 `重置` 行为会把棋盘清空为白板。
  - 现在我们有“随机种子 + 可复现”的机制，用户期望 `重置` 能回到“该 seed 对应的初始盘面”。
- 目标：
  - 点击 `重置` 后：
    - 自动暂停
    - 使用**当前 seed** 重新初始化盘面（A/B/C 在 `y=0` 随机单点，允许同格叠加）
    - 重置 RNG 状态，使后续演化随机序列从该 seed 的起点重新开始（保证可复现）
- 非目标：
  - 不新增“清空白板”的独立按钮/模式（如需要另开需求）
  - 不改变 seed 的值（只是用当前 seed 重置）

## 1. 影响范围（必须）
- 影响的 repo（来自 docmap，可多项）：lifegame-plus
- 影响的模块/目录/文件（按 repo 分组列出即可）：
  - repo: lifegame-plus
    - `src/lifegame-plus/web/main.js`
      - 将 `重置` 从“清空棋盘”改为“按当前 seed 重新初始化”（等价于重新应用当前 seed + reroll）
- 外部可见变化（如适用：API/CLI/配置/数据格式）：
  - UI 行为：`重置` 不再清空白板，而是回到当前 seed 的初始盘面

## 2. 方案与改动点（必须）
说明：实现将按批次推进；每批次写入前需先列出本批次改动文件/影响并征求确认。

- repo: lifegame-plus
  - 改动点：
    - 复用现有 `applySeed(seed, { rerollGrid: true })` 逻辑：
      - `seed` 使用 `currentSeed`
      - 触发后会 `setPlaying(false)` 并调用 `randomizeGrid()`，且 `nextRandom` 会从该 seed 重新初始化
    - `resetGrid()`（清空白板）不再由 UI 直接调用（保留函数或删除由实现时决定，优先最小改动）
  - 新增/修改的接口或数据结构：无
  - 关键逻辑说明：
    - “按当前 seed 重置”必须同时重置 RNG 状态，否则会因为 RNG 已被播放消耗导致初始化位置不一致

## 3. 自测与验收口径（必须，可执行）
- 本地自测步骤（命令/操作）：
  1) `python3 -m http.server 8000`
  2) 打开 `http://127.0.0.1:8000/src/lifegame-plus/web/`
  3) 记下当前 seed 与初始化三点位置（或截图）
  4) 点击 `播放` 运行若干步后暂停
  5) 点击 `重置`：应回到与第 3 步一致的初始盘面（同 seed）
  6) 再次点击 `重置`：初始盘面保持一致（幂等）
- 关键用例清单：
  - 播放中点击 `重置`：应自动暂停并回到初始盘面
  - 同 seed 下多次 `重置`：初始盘面一致
  - 改 seed 后 `重置`：回到新 seed 对应的初始盘面
- 通过标准：
  - `重置` 使用当前 seed 重新初始化盘面，且可复现（RNG 状态被重置）

### 3.1 自测记录（实际执行）
- `node --check src/lifegame-plus/web/main.js`：通过
- 手动验收要点：播放后点击 `重置` 回到同 seed 初始盘面（幂等）：通过
- 用户验收：通过（允许更新 SOT 并归档）

交付摘要口径（固定）：实现完成后，必须输出交付摘要，包含：
- 实际改动清单（按 repo 列出关键文件/模块）
- 自测步骤与结果
- 对照本节“通过标准”的逐条结论
- 已知风险/未决事项（如有必须列出）

约束：用户验收通过前，不更新 SOT，不归档 WIP。

## 4. SOT 更新清单（必须）
用户验收通过后，要把“最终事实”沉淀到 SOT：

- `docs/sot/overview.md`：更新 `重置` 的行为说明（按当前 seed 重置初始盘面）
- `docs/sot/architecture.md`：如其中描述了 `重置=清空白板`，则同步修正（否则可不改）

## 5. 完成后归档动作（固定）
实现完成并完成基本自测后：
1) 输出交付摘要并请求用户验收
2) 用户验收通过后，按第 4 节更新 SOT
3) 更新第 6 节检查单（必须全勾）
4) 将整个目录从 `docs/wip/20260112-reset-reinit-by-seed/` 移动到 `docs/archive/20260112-reset-reinit-by-seed/`

## 6. WIP 检查单（必须全勾才能归档）
- [x] plan.md 已确认（PLAN 闸门已通过）
- [x] 代码改动已完成（IMPLEMENT 完成）
- [x] 基本自测已完成（记录命令/步骤与结果）
- [x] 已输出交付摘要并且用户验收通过（VERIFY 闸门已通过）
- [x] SOT 已更新（`docs/sot/overview.md`、`docs/sot/architecture.md`）
- [x] 已归档：wip → archive（目录已移动）
